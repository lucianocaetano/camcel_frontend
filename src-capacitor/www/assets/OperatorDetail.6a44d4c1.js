import{aF as D,aP as V,a as z,r as w,a2 as s,aa as x,a6 as n,a5 as o,a4 as a,aG as B,a3 as p,ad as g,a9 as f,ac as b,a7 as O,H as E,ak as L,ai as y,ae as C,ab as k}from"./index.c97da185.js";import{_ as q,b as v,Q}from"./QCardSection.3bdf9a7a.js";import{Q as N}from"./QMarkupTable.915e59d6.js";import{b as M}from"./axios.3d912423.js";import{Q as U}from"./QInput.9d3d625c.js";import{Q as A}from"./QCheckbox.337e149d.js";import{Q as S}from"./QForm.2ebf8009.js";import{Q as T}from"./QCardActions.ba5cce65.js";import{Q as j}from"./QDialog.d42c9718.js";import{C as F}from"./ClosePopup.e72f02d5.js";import{T as H,c as R,d as I,u as P}from"./TableDocuments.a9f8b6fe.js";import"./user.store.7bf26499.js";import"./pinia.485b638e.js";import"./QFile.3a1fda0e.js";import"./QChip.ba98e3ca.js";import"./format.a8cdc0f5.js";const G={props:{show:{type:Boolean,required:!0},operator:{type:Object,required:!0}},setup(l,{emit:t}){const _=D(l,"show"),{params:e}=V(),m=z({ci:l.operator.ci,name:l.operator.name,authorized:l.operator.is_valid==="Autorizado",role_description:l.operator.cargo}),h=w(null),d=()=>{t("handleCloseUpdateOperator")};return{dataUpdateOperator:m,handleUpdateOperator:()=>{M.put(`enterprises/${e.enterprise}/operators/${l.operator.id}`,m).then(()=>{d()}).catch(u=>{if(console.log(u),u.response.status===422){const r=u.response.data.errors;h.value=r}})},handleCloseUpdateOperator:d,error_update:h,show:_}}},J={style:{},class:"q-pa-xs bg-negative text-white"},K={style:{},class:"q-pa-xs bg-negative text-white"},W={style:{},class:"q-pa-xs bg-negative text-white"};function X(l,t,_,e,m,h){return s(),x(j,{modelValue:e.show,"onUpdate:modelValue":t[4]||(t[4]=d=>e.show=d)},{default:n(()=>[o(Q,{style:{width:"900px"}},{default:n(()=>[o(v,null,{default:n(()=>t[5]||(t[5]=[a("div",{class:"text-h6"},"Editar operador",-1)])),_:1}),o(v,{class:"q-pt-none"},{default:n(()=>[o(S,{onSubmit:B(e.handleUpdateOperator,["prevent"])},{default:n(()=>{var d,c,u;return[o(U,{name:"C\xE9dula",required:"",label:"C\xE9dula",modelValue:e.dataUpdateOperator.ci,"onUpdate:modelValue":t[0]||(t[0]=r=>e.dataUpdateOperator.ci=r)},null,8,["modelValue"]),(s(!0),p(b,null,g((d=e.error_update)==null?void 0:d.ci,(r,i)=>(s(),p("div",{key:i,class:"q-mt-sm"},[a("span",J,f(r),1)]))),128)),o(U,{name:"Nombre",required:"",label:"Nombre",modelValue:e.dataUpdateOperator.name,"onUpdate:modelValue":t[1]||(t[1]=r=>e.dataUpdateOperator.name=r)},null,8,["modelValue"]),(s(!0),p(b,null,g((c=e.error_update)==null?void 0:c.nombre,(r,i)=>(s(),p("div",{key:i,class:"q-mt-sm"},[a("span",K,f(r),1)]))),128)),o(A,{label:"Autorizado",modelValue:e.dataUpdateOperator.authorized,"onUpdate:modelValue":t[2]||(t[2]=r=>e.dataUpdateOperator.authorized=r)},null,8,["modelValue"]),o(U,{name:"Cargo",required:"",label:"Cargo",modelValue:e.dataUpdateOperator.role_description,"onUpdate:modelValue":t[3]||(t[3]=r=>e.dataUpdateOperator.role_description=r)},null,8,["modelValue"]),(s(!0),p(b,null,g((u=e.error_update)==null?void 0:u.authorize,(r,i)=>(s(),p("div",{key:i,class:"q-mt-sm"},[a("span",W,f(r),1)]))),128)),o(O,{label:"Editar",class:"q-mt-md",type:"submit",color:"primary"})]}),_:1},8,["onSubmit"])]),_:1}),o(T,{align:"right"},{default:n(()=>[E(o(O,{flat:"",label:"Cerrar",color:"primary",onClick:e.handleCloseUpdateOperator},null,8,["onClick"]),[[F]])]),_:1})]),_:1})]),_:1},8,["modelValue"])}var Y=q(G,[["render",X]]);const Z={components:{MenuEditOperator:Y,TableDocuments:H},setup(){const{params:l}=V(),t=L(),{operator:_,isLoading:e,refetch:m}=R(l.enterprise,l.pk),{documents:h,isLoading:d,refetch:c}=I(l.enterprise,l.pk),u=()=>t.push("/enterprise/"+l.enterprise),r=async()=>{await P(l.enterprise,l.pk),m()},i=w(!1);return{updateOperator:i,handleCloseUpdateOperator:()=>{i.value=!1,m()},handleOpenUpdateOperator:()=>i.value=!0,operator:_,documents:h,isLoading:e&&d,refetchDocuments:c,handleOutClick:u,handleDeleteClick:r}}},$={key:0,class:"q-pa-md"},ee={class:"flex justify-between q-mb-md"},te={class:"flex justify-between"},ae={class:"text-left"},re={class:"text-right"},oe={class:"text-right"},le={class:"text-right"},se={key:2,class:"text-center"};function ne(l,t,_,e,m,h){const d=y("table-documents"),c=y("MenuEditOperator");return s(),p("div",null,[e.isLoading?C("",!0):(s(),p("div",$,[a("div",ee,[o(O,{color:"primary",flat:"",onClick:e.handleOutClick},{default:n(()=>t[0]||(t[0]=[k("salir")])),_:1},8,["onClick"]),a("div",te,[o(O,{color:"primary q-mr-md",onClick:e.handleOpenUpdateOperator},{default:n(()=>t[1]||(t[1]=[k(" Editar ")])),_:1},8,["onClick"]),o(O,{color:"negative",onClick:e.handleDeleteClick},{default:n(()=>t[2]||(t[2]=[k("Borrar")])),_:1},8,["onClick"])])]),o(Q,{class:"my-card",flat:"",bordered:""},{default:n(()=>[o(v,null,{default:n(()=>t[3]||(t[3]=[a("div",{class:"text-h6"},"Datos del operario",-1)])),_:1}),o(N,null,{default:n(()=>[t[4]||(t[4]=a("thead",null,[a("tr",null,[a("th",{class:"text-left"},"C.I."),a("th",{class:"text-right"},"Nombre"),a("th",{class:"text-right"},"Autorizaci\xF3n"),a("th",{class:"text-right"},"Cargo")])],-1)),a("tbody",null,[a("tr",null,[a("td",ae,f(e.operator.ci),1),a("td",re,f(e.operator.name),1),a("td",oe,f(e.operator.is_valid),1),a("td",le,f(e.operator.cargo),1)])])]),_:1})]),_:1}),e.documents?(s(),x(d,{key:0,documents:e.documents,isOperator:!0},null,8,["documents"])):C("",!0)])),e.updateOperator?(s(),x(c,{key:1,onHandleCloseUpdateOperator:e.handleCloseUpdateOperator,operator:e.operator,show:e.updateOperator},null,8,["onHandleCloseUpdateOperator","operator","show"])):C("",!0),e.isLoading?(s(),p("div",se,"Cargando...")):C("",!0)])}var Ve=q(Z,[["render",ne]]);export{Ve as default};
